<style>
    body{
        padding: 0;
        margin: 0;
    }
    body,html{
        width: 100%;
        height: 100%;
    }
    li,ul,h3{
        padding: 0;
        margin: 0;
        list-style: none;
    }
    .c-contain{
        font-size: 12px;
        color: #999;
        width: 100%;
        height: 100%;
        overflow-x: hidden;
        overflow-y: auto;
    }
    .c-contain>.c-con-item{
        float: left;
        width: 32%;
        height: 100%;
    }
    .c-contain .c-con-middle{
        margin: 0 2%;
    }
    .c-contain .c-con-box{
        width: 100%;
        border: solid 1px #ddd;
        padding: 20px;
        box-sizing: border-box;
        box-shadow: 0 0 5px #ddd;
        margin-left: -20px;
        overflow: hidden;
        margin-top: 10px;
        border-radius: 3px
    }
    .c-contain .c-con-box .c-item{
        position: relative;
        margin-left: 20px;
    }
    /*.c-contain .c-con-box .c-item:after{
      position: absolute;
      left: -11px;
      top: 23px;
      width: 1px;
      height: 100%;
      border-left: dotted 1px #ddd;
      z-index: 1;
      content: ''
    }*/
    .c-contain .c-con-box .c-menu-list{
        margin-left: 20px;
    }
    .c-contain .c-con-box .c-item input{
        vertical-align: middle;
    }
    .c-contain .c-con-box .c-item span{
        vertical-align: middle;
    }
    .c-contain .c-con-box .c-item h3{
        position: relative;
        line-height: 30px;
    }
    .c-contain .c-con-box .c-item h3 .c-die{
        position: absolute;
        left: -16px;
        top: 10px;
        width: 12px;
        height: 12px;
        cursor: pointer;
        z-index: 20;
    }
    /*.c-contain .c-con-box .c-item h3 .c-die:after{
      position: absolute;
      left: 12px;
      top: 6px;
      width: 10px;
      height: 1px;
      border-top: dotted 1px #ddd;
      content: ''
    }*/
    .c-contain .c-con-box .c-item h3.shou .c-die{
        background:url(/3.0/package/authTree/img/shou.gif);
    }
    .c-contain .c-con-box .c-item h3.zhan .c-die{
        background:url(/3.0/package/authTree/img/zhan.gif);
    }
    .c-contain .c-con-box .c-item .c-menu-list{
        position: relative;
        margin-top: -7px;
        padding-top: 7px;
    }
    .c-contain .c-con-box .c-item .c-menu-list:before{
        position: absolute;
        left: -10px;
        top: 0;
        width: 1;
        height: calc(100% - 12px);
        border-left: dotted 1px #ddd;
        content: ''
    }
    .c-contain .c-con-box .c-item .c-menu-list li{
        position: relative;
        line-height: 20px;
    }
    .c-contain .c-con-box .c-item h3 .c-line{
        position: absolute;
        left: -28px;
        top: -3px;
        width: 10px;
        height: 18px;
        border-bottom: dotted 1px #ddd;
    }
    .c-contain .c-con-box .c-item .shou+.c-menu-list{
        display: none;
    }
    .c-contain .c-con-box .c-item .c-menu-list li .c-line{
        position: absolute;
        left: -10px;
        top: -8px;
        width: 10px;
        height: 18px;
        border-bottom: dotted 1px #ddd;
    }
</style>
<div class="c-contain">
    {notempty name="authList"}
        <input type="hidden" name="rules[]" class="all-check" value="-1">
        <!--left-->
        <div class="c-con-item c-con-left">
        {notempty name="authList.left"}
        {volist name="authList.left" id="vo"}
            <div class="c-con-box">
                <div class="c-item c-level-1" data-level="1">
                    <h3>
                        <!-- <div class="c-die"></div> -->
                        <input type="checkbox" id="lable_{$vo.id}" name="rules[]" class="all-check" value="{$vo.id}" {if condition="in_array($vo['id'],$userAuth)"}checked{/if}>
                        <span><label for="lable_{$vo.id}">{$vo.title}</label></span>
                    </h3>
                    <ul class="c-menu-list">
                    {notempty name="vo['_child']"}
                    {:action('Base/tree', array($vo['_child'],1,'auth'))}
                    {/notempty}
                    </ul>
                </div>
            </div>
        {/volist}
        {/notempty}
        </div>

        <!--middle-->
        <div class="c-con-item c-con-middle">
        {notempty name="authList.middle"}
        {volist name="authList.middle" id="vo"}
            <div class="c-con-box">
                <div class="c-item c-level-1" data-level="1">
                    <h3>
                        <!-- <div class="c-die"></div> -->
                        <input type="checkbox" id="lable_{$vo.id}" name="rules[]" class="all-check" value="{$vo.id}" {if condition="in_array($vo['id'],$userAuth)"}checked{/if}>
                        <span><label for="lable_{$vo.id}">{$vo.title}</label></span>
                    </h3>
                    <ul class="c-menu-list">
                    {notempty name="vo['_child']"}
                    {:action('Base/tree', array($vo['_child'],1,'auth'))}
                    {/notempty}
                    </ul>
                </div>
            </div>
        {/volist}
        {/notempty}
        </div>

        <!--right-->
        <div class="c-con-item c-con-right">
        {notempty name="authList.right"}
        {volist name="authList.right" id="vo"}
            <div class="c-con-box">
                <div class="c-item c-level-1" data-level="1">
                    <h3>
                        <!-- <div class="c-die"></div> -->
                        <input type="checkbox" id="lable_{$vo.id}" name="rules[]" class="all-check" value="{$vo.id}" {if condition="in_array($vo['id'],$userAuth)"}checked{/if} >
                        <span><label for="lable_{$vo.id}">{$vo.title}</label></span>
                    </h3>
                    <ul class="c-menu-list">
                        {notempty name="vo['_child']"}
                        {:action('Base/tree', array($vo['_child'],1,'auth'))}
                        {/notempty}
                    </ul>
                </div>
            </div>
        {/volist}
        {/notempty}
        </div>
    {/notempty}
    <input type="hidden" name="id" value="{$info.id|default='0'}">
    <input type="hidden" name="detail_id" value="{$info.detail_id|default='0'}">
</div>

<script>
;$(function(){
    $(".c-con-box").on("click",".shou>.c-die",function(){   //展开
        var parent = $(this).parent();
        parent.removeClass('shou').addClass('zhan');
        parent.next().slideDown();
    })
    $(".c-con-box").on("click",".zhan>.c-die",function(){   //收起
        var parent = $(this).parent();
        parent.removeClass('zhan').addClass('shou');
        parent.next().slideUp();
    })

    //全选-全取消
    $(".c-con-box").on("change",".all-check",function(){
        if($(this).is(":checked")){
            $(this).parent().parent().find("input").prop("checked",true);
        }else{
            $(this).parent().parent().find("input").prop("checked",false);
        }
        var num = parseInt($(this).parent().parent().attr("data-level"))+1;
        doCheck($(this),num);
    })

    //单个选择
    $(".c-con-box").on("change",".one-check",function(){
        var num = parseInt($(this).parent().parent().parent().attr("data-level"))+1;
        doCheck($(this),num);
    })
    function doCheck(obj,m){
        if(obj.is(":checked")){
            for(var i=1; i<m; i++){
                obj.parents(".c-level-"+i).children("h3").find(".all-check").prop("checked",true);
            }
        }else{
            for(var n = 1; n<m; n++){
                if(obj.parents(".c-level-"+n).children('.c-menu-list').find(".one-check:checked").length == 0){
                    obj.parents(".c-level-"+n).children("h3").find(".all-check").prop("checked",false);
                }
            }
        }
    }
})
</script>